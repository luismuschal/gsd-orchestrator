---
phase: 01-foundation-dashboard
plan: 04
type: execute
wave: 4
depends_on: ["01-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can authenticate with GitHub and access dashboard"
    - "Dashboard shows real-time workflow status updates"
    - "User can trigger workflows and see them start on GitHub"
    - "All data persists across application restarts"
  artifacts: []
  key_links: []
---

<objective>
Verify complete Phase 1 functionality with human testing.

Purpose: Ensure all Phase 1 requirements are satisfied through comprehensive manual testing of the full authentication → dashboard → workflow trigger flow.

Output: Verified working system meeting all 7 Phase 1 requirements
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-dashboard/01-01-SUMMARY.md
@.planning/phases/01-foundation-dashboard/01-02-SUMMARY.md
@.planning/phases/01-foundation-dashboard/01-03-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Phase 1 system:
- Fastify backend server with SQLite database
- GitHub App OAuth authentication
- GitHub API integration with smart polling
- React dashboard UI with repo management
- Workflow status indicators and manual dispatch
  </what-built>
  
  <how-to-verify>
**Prerequisites:**
1. Ensure .env file is configured with all GITHUB_* variables from GitHub App setup
2. Ensure github-app-private-key.pem is in project root

**Test Sequence:**

**Step 1: Start Application**
```bash
# Terminal 1 - Backend
npm run dev

# Terminal 2 - Frontend
npm run dev:client
```

Expected: Both servers start without errors. Backend logs show "Server listening", "Database initialized", "Auth routes registered", "Polling service started".

**Step 2: OAuth Authentication**
1. Open browser to http://localhost:5173
2. Dashboard should load (may show empty state if not authenticated)
3. Test auth status: Open DevTools Console, run:
   ```javascript
   fetch('/api/auth/status').then(r => r.json()).then(console.log)
   ```
4. If not authenticated, visit http://localhost:3000/api/auth/login
5. Should return JSON with GitHub auth URL
6. Copy URL to browser, authorize GitHub App
7. Should redirect back to http://localhost:3000/api/auth/callback with code
8. Should redirect to http://localhost:5173/dashboard
9. Verify auth status again - should show `authenticated: true`

**Step 3: Add Repository (Requirement AUTH-02, DASH-01)**
1. In Dashboard, find "Add Repository" form
2. Enter:
   - Owner: `octocat` (or your GitHub username)
   - Name: `Hello-World` (or one of your repos)
3. Click "Add" button
4. Verify:
   - Repo card appears in dashboard
   - Card shows owner/name correctly
   - Card shows "Added [date]"
   - No error messages

**Step 4: Verify Workflow Status (Requirements DASH-02, DASH-03)**
1. Wait 15 seconds for first poll cycle
2. Repo card should update with workflow runs (if any exist)
3. Check status badges:
   - Green badge = success (completed successfully)
   - Red badge = failure (completed with errors)
   - Blue pulsing badge = running (in progress)
   - Yellow badge = queued (waiting to start)
   - Gray badge = cancelled/skipped
4. If repo has no workflow runs, that's OK - proceed to Step 5

**Step 5: Trigger Workflow (Requirement EXEC-01)**
1. Click "Trigger Workflow" button on repo card
2. Should see alert: "Workflow main.yml dispatched!"
3. Go to GitHub Actions page for the repo in browser
4. Verify new workflow run started (check timestamp)
5. Wait 30 seconds, return to dashboard
6. Verify new workflow run appears in repo card
7. Verify status badge shows "running" (blue, pulsing)
8. Wait for workflow to complete (may take 1-2 minutes)
9. Refresh dashboard, verify status badge changes to "success" (green) or "failure" (red)

**Step 6: Persistence Test (Requirement AUTH-03)**
1. Stop backend server (Ctrl+C in Terminal 1)
2. Verify database file exists: `ls -la data/orchestrator.db`
3. Restart backend: `npm run dev`
4. Refresh dashboard in browser
5. Verify:
   - Added repos still visible
   - Workflow run history still present
   - No data loss after restart

**Step 7: Remove Repository**
1. Click "Remove" button on a repo card
2. Confirm in dialog
3. Verify:
   - Repo card disappears immediately
   - Database updated: Check with `sqlite3 data/orchestrator.db "SELECT * FROM repos;"`
   - Repo no longer listed

**Step 8: Multi-Repo Test**
1. Add 2-3 different repos
2. Verify all display in grid layout
3. Verify each has independent workflow status
4. Trigger workflows on multiple repos
5. Verify status updates for each independently

**Step 9: Real-Time Updates (Requirement DASH-02)**
1. Ensure at least one repo card has active workflows
2. Watch dashboard for 30-60 seconds without refreshing
3. Verify workflow status updates automatically (every ~10s)
4. Look for badge changes (queued → running → success)
5. No manual refresh needed

**Step 10: Visual & UI Checks**
1. Check responsive layout:
   - Resize browser window from wide (3 cols) to narrow (1 col)
   - Verify cards reflow properly
2. Check accessibility:
   - Tab through interactive elements (buttons, inputs)
   - Verify focus indicators visible
   - Verify clickable areas adequate
3. Check styling:
   - Cards have shadows and proper spacing
   - Buttons have hover states
   - Status badges clearly visible
   - No layout breaks or overlaps

**Step 11: Error Handling**
1. Try adding invalid repo (e.g., "invalid/nonexistent-repo-12345")
2. Verify error message displayed (not silent failure)
3. Try adding duplicate repo
4. Verify handled gracefully
5. Check backend logs for any unexpected errors

**Phase 1 Success Criteria Checklist:**

- [ ] User can authenticate with GitHub OAuth (AUTH-01)
- [ ] User can configure which repos to track via dashboard form (AUTH-02)
- [ ] System maintains GitHub API connection and tokens (AUTH-03)
- [ ] User can view all repos in unified dashboard (DASH-01)
- [ ] User can see real-time workflow status for each repo (DASH-02)
- [ ] User can see visual status indicators (success/failure/running) (DASH-03)
- [ ] User can trigger workflows manually from dashboard (EXEC-01)
- [ ] Data persists across app restarts
- [ ] No critical errors in console or logs
- [ ] UI is responsive and accessible
  </how-to-verify>
  
  <resume-signal>
Type one of:
- `approved` - All tests passed, Phase 1 complete
- `approved with notes: [describe minor issues]` - Functional but has non-blocking issues
- `issues found: [describe problems]` - Tests failed, needs fixes

If issues found, describe what didn't work and execution will resume to address them.
  </resume-signal>
</task>

</tasks>

<verification>
This checkpoint verifies all 7 Phase 1 requirements through manual testing of the complete user flow.
</verification>

<success_criteria>
1. All Phase 1 requirements verified working (AUTH-01/02/03, DASH-01/02/03, EXEC-01)
2. Human tester confirms full flow works end-to-end
3. No critical bugs or errors found
4. System ready for Phase 2 development
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-dashboard/01-04-SUMMARY.md`
</output>
